<!DOCTYPE html>
<!DOCTYPE html>
<html>
<head>
    <title>XYZ Maps Example: Add and remove link feature</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/paper/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" href="css/navbar-fixed-right.min.css">
    <link rel="stylesheet" href="css/navbar-fixed-left.min.css">
    <link rel="stylesheet" href="css/docs.css">

    <script src="js/xyz-maps-common.min.js"        type="text/javascript" charset="UTF-8" ></script>
    <script src="js/xyz-maps-core.min.js"  type="text/javascript" charset="UTF-8" ></script>
    <script src="js/xyz-maps-display.min.js"      type="text/javascript" charset="UTF-8" ></script>
    <script src="js/xyz.js"      type="text/javascript" charset="UTF-8" ></script>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="js/docs.js"></script>
    <script async defer src="https://buttons.github.io/buttons.js"></script>

    <style type="text/css">
        #map {
        position: absolute;
        overflow: hidden;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        }

        .navbar-inverse{
        background-color:#123
        }

    </style>
</head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-left">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">XTrack</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li><a href="#">Home</a></li>
                <li><a href="#">About</a></li>
                <li><a href="#">Contact</a></li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Dropdown <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="#">Action</a></li>
                        <li><a href="#">Another action</a></li>
                        <li><a href="#">Something else here</a></li>
                        <li role="separator" class="divider"></li>
                        <li class="dropdown-header">Nav header</li>
                        <li><a href="#">Separated link</a></li>
                        <li><a href="#">One more separated link</a></li>
                    </ul>
                </li>
            </ul>

        </div>
    </div>
</nav>

<div id="map"></div>
<pre id="infoParent" style="display:none;position:absolute;background:white;width:400px;"><div style="overflow:auto" id="info" class="properties">

</div></pre>
<a id="linkbutton" class="button">Add Links</a>

<script type="application/javascript">
			// specify your token
			var YOUR_ACCESS_TOKEN = window.parent.YOUR_ACCESS_TOKEN;
            var APP_ID   = 'vL1txg69g49VIQ2ugm90';
            var APP_CODE = 'YwloGJ2vn2kVemBNNkp4hA';


			 //url: 'https://{SUBDOMAIN_INT_1_4}.base.maps.api.here.com/maptile/2.1/maptile/newest/reduced.night/{LEVEL}/{COL}/{ROW}/256/png8?app_id='+APP_ID+'&token='+APP_CODE+'&lg=/eng'


			var imageLayer = new HERE.xyz.maps.layers.TileLayer({
        			name: 'Image Layer',
                    min: 8,
                    max: 26,
                    provider: new HERE.xyz.maps.providers.ImageProvider({
			            name: 'Live Map',
                        url: 'https://{SUBDOMAIN_INT_1_4}.base.maps.api.here.com/maptile/2.1/maptile/newest/reduced.night/{LEVEL}/{COL}/{ROW}/256/png8?app_id='+APP_ID+'&token='+APP_CODE+'&lg=/eng'

   			        })
				}),
				linkLayer = new HERE.xyz.maps.layers.TileLayer({
        			name: 'my Link Layer',
                    min: 8,
                    max: 26,
                    provider: new HERE.xyz.maps.providers.LocalProvider ({
					    name:  'my Link Provider'
					}),
				    style: {
					    styleGroups: {
					    	style: [
					    		{zIndex: 0, type: "Circle", radius:12, "strokeWidth":2, "stroke": "#FFFFFF", "fill": "#1188DD"}
					    	]
					    },
					    assign: function(feature){
					    	return "style";
					    }
				    }
				});

			// setup the Map Display
			window.display = new  HERE.xyz.maps.Map( document.getElementById("map"), {
			    zoomLevel : 12,
			    center: {
			        longitude: -117.145577, latitude: 32.707129
			    },

			    // add layers to display
			    layers: [imageLayer, linkLayer],

			    credentials: {
					access_token: YOUR_ACCESS_TOKEN
			    }
			});


/*###visiblesource*/
var AddedLinks = [];

<!--document.querySelector("#linkbutton").onclick = function(){-->
	<!--if(!AddedLinks.length){-->
		<!--AddedLinks = linkLayer.addFeature(Links);-->

		<!--this.innerText="Remove Links";-->
	<!--}-->
	<!--else{-->
		<!--// Remove the added link Feature-->
		<!--AddedLinks.forEach(function(link){-->
			<!--linkLayer.removeFeature(link);-->
		<!--})-->
		<!--AddedLinks = [];-->

		<!--this.innerText="Add Links";-->
	<!--}-->
<!--};-->
//https://xyz.api.here.com/hub/spaces/Z6djkHZL/search?access_token=kXcVh-Rn9QReOg14lcrDuw&tags=quality
function loadxyz(){
    //let xyz = new XYZ("Z6djkHZL","kXcVh-Rn9QReOg14lcrDuw");
    let xyz = new XYZ("vZHKTtZ5","uT_aq8td0LiGjUeibVYEgg");

    xyz.fetch(1000).then(data=>{
        var geom = data.features[0].geometry.coordinates;
        display.setCenter(geom[0],geom[1]);
        AddedLinks = linkLayer.addFeature(data);
    });
}
loadxyz();

var infoTag = document.querySelector("#info");
var infoParent = document.querySelector("#infoParent");


function eventHandler(evt){
	if(evt.target){
		var properties = evt.target.properties;
        infoParent.style.left=evt.mapX+"px";
        infoParent.style.top=evt.mapY+"px";
        infoParent.style.display="block";
		infoTag.innerText = JSON.stringify(properties, undefined, 4);
	}
	else{
		infoTag.innerText = "No feature is clicked!";
		infoParent.style.display="none";
	}
}



// add event listener to pointerup
window.display.addEventListener('pointerup', eventHandler);

    </script>
</body>
</html>